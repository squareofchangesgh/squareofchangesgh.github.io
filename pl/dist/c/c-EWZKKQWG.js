import{a as A}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-35NZNUAA.js";import{a as F,b as M,c as T}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-Y33WE3PZ.js";import{b as N,c as h,h as V,l as x,r as _}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-RTVVU7ZZ.js";import{B as S,C as H}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-BI3IXJ7B.js";import{a as w,d as B}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-EJ6UYQ42.js";import{a as v,e as k,g as y,h as R}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-5R57BBFA.js";import{D as m,F as b}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-VNZOBZZU.js";import{a as I}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-MBWT6D3G.js";import{d as C}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TZYDFHR2.js";B();T();var f=C(I());N();T();R();var s=C(I());_();function U({interactions:i,player:t,sharedState:r}){let{clickCount:l,isPlayerReady:a,isPointerIn:L,hoverPercent:p,scrollPercent:d,isStarted:g}=y(r),c=(0,s.useRef)(v({loopCount:0,prevClickCount:0,isSecondClickPending:!1,isUnholdPending:!1,isUnhoverPending:!1,isReverseActionInProgress:!1})).current,n=(0,s.useMemo)(()=>{let e={};for(let o of i)e[o.type]=V(i,o.type);return e},[i]);(0,s.useEffect)(()=>{let e=i[0];if(!e)return;function o(){e?.direction===-1?t.seek(e.range?.[1]||t.state.totalFrames-1||0):e.range&&t.seek(e.range[0]||0)}return t.addEventListener("Ready",o,{once:!0}),()=>t.removeEventListener("Ready",o)},[]);function P(e){let o=-(e.direction||1);t.play({direction:o,loop:!1})}(0,s.useEffect)(()=>{let e=n.click;if(!e||c.prevClickCount===l)return;let o=D(e),u=o==="reverse"?!1:e.loop;!c.isSecondClickPending||t.state.isComplete&&e.secondAction!=="reverse"?(t.state.isComplete&&t.stop(),t.play({range:e.range,loop:u,loopCount:e.loopInfinite?void 0:e.loopCount,direction:e.direction,speed:e.speed}),c.isSecondClickPending=!0):(o==="reverse"?P(e):t.pause(),c.isSecondClickPending=!1),c.prevClickCount=l},[n,l,t]),(0,s.useEffect)(()=>{let e,o=n.load;if(o){if(a&&g){let u=typeof o.delay=="number"?o.delay*1e3:0;e=setTimeout(()=>{t.play({range:o.range,loop:o.loop,loopCount:o.loopInfinite?void 0:o.loopCount,direction:o.direction,speed:o.speed})},u)}return()=>clearTimeout(e)}},[n,a,t,g]),(0,s.useEffect)(()=>{let e=n.hover;if(!e)return;let o=D(e),u=o==="reverse"?!1:e.loop;L?(t.play({range:e.range,loop:u,loopCount:e.loopInfinite?void 0:e.loopCount,direction:e.direction,speed:e.speed}),c.isUnhoverPending=!0):c.isUnhoverPending&&(o==="reverse"?P(e):t.pause(),c.isUnhoverPending=!1)},[n,L,t]),(0,s.useEffect)(()=>{let e=n.cursor;e&&t.seek(E({range:e.range,percent:p,totalFrames:t.state.totalFrames,direction:e.direction,loopCount:e.loop?e.loopCount:void 0,bounce:e.loop==="swing"}))},[n,p,t,t.state.totalFrames]),(0,s.useEffect)(()=>{let e=n.scroll;if(!e)return;let o=e.scrollType!=="relative"?e.loopInfinite??!0:!1;t.seek(E({range:e.range,percent:d,totalFrames:t.state.totalFrames,direction:e.direction,loopCount:e.loop?o?h:e.loopCount??1:1,bounce:e.loop==="swing"}))},[n,d,t,t.state.totalFrames])}function E({range:i,percent:t=0,totalFrames:r=0,direction:l,loopCount:a=1,bounce:L}){let p=i||[0,r-1],d=p[0],g=p[1],c=Math.max(Math.min(t,1),0),n=Math.max(g-d+1,0),P=n*a,e=Math.max(Math.round((P-1)*c),0),o=e%n;l===-1&&(o=n-o-1);let u=Math.floor(e/n);return L&&u%2&&(o=n-o-1),o=Math.max(Math.min(o+d,r-1),0),o}function D(i){return i.secondAction||x()}R();H();b();var W=[],O=(0,f.forwardRef)(({widget:i,sharedState:t,isVisible:r},l)=>{let[a]=(0,f.useState)(()=>new F);return(0,f.useEffect)(()=>{r&&(t.isStarted=!0)},[t,r]),U({interactions:i.interactions||W,player:a,sharedState:t}),m(w,{width:"100%",height:"100%",pointerEvents:"none",ref:l,children:m(M,{uri:i.uri,player:a,onReady:()=>{t.isPlayerReady=!0,t.player=k(a)}})})});function le(i){let{ref:t,inView:r}=A();return m(O,{ref:t,isVisible:r,...i})}function ue(i){let t=S(r=>r.visibility.aboutToShow);return m(O,{isVisible:t,...i})}export{le as a,ue as b};
