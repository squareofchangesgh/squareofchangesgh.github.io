import{a as t}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-2TSYQWVN.js";import{a as o,b as p,c as r,d as w}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-2TB4DHXQ.js";import{a as h}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-52YGOH7N.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-OKZSTQSX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-L26XEBE2.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-YIBTG3FD.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-UKSEGKUL.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-6BSZRDIS.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-42SFA7ZB.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-5JUHDQEW.js";import{a as e,b as u}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-SN7J37LE.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TQMFKW4O.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-5SLUZRMW.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-K45ZXRYF.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-2RBJCKMX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-4NSILI54.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-PEYC24KP.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-XJQ7OF5W.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-22ZYTENX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-I6RXPP7W.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TW324QB3.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-DQDVK4WP.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-MXQB3LDA.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-THKPLK5P.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-7JDZLQQ4.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-JWQSDUFI.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-SUQN7X7E.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-EJ6UYQ42.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-WVUZA6DL.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-42TSFLLH.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TBONR54I.js";import{a as g}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-JTEJSVZP.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-OEU46UX3.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-5R57BBFA.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-G4GX3XOZ.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-Y3K5ZMDI.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-HKXDGYOU.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-Y4QUC5YI.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-US7HSDUX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-AG4TV67I.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-VRG4AYQX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-VNZOBZZU.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-MBWT6D3G.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-BHZEZWL4.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-VUD7OPNE.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-M4TEEAX7.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-SXBIDYQQ.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-PR2DJXFR.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-GJYOXBH4.js";import{a as c}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-3SFTLRL3.js";import{b as a}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-W2OJRSJR.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-CDLDI33S.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-KGGRYMSL.js";import{d as i}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TZYDFHR2.js";var n=i(c()),s=i(a()),l=i(g());p();u();w();var m=t.extend({render:function(){return this.rendered=!0,this.template=h["template-viewer-widget-background"],this.setElement(this.template({data:this})),this.$el.prependTo(this.page.$fixedBgContainer),this.$picture=this.$(".picture-background"),this.$video=this.$(".video-background"),this.$videoContainer=this.$(".video-container"),this.$slideshow=this.$(".slideshow-container"),this.$slideshowPreload=this.$(".slideshow-preload"),this.picture&&this.selectedType==="picture"?this.renderPicture():!s.default.isEmpty(this.video)&&this.selectedType==="video"?this.renderVideo():this.slideshow&&this.selectedType==="slideshow"?this.renderSlideshow():this.widgetIsLoaded(),this},start:function(){return this.started=!0,this.selectedType==="video"&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.start(),this.selectedType==="slideshow"&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&!this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.startAnimationLoop(),this},stop:function(){return this.started=!1,this.selectedType==="video"&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.stop(),this.selectedType==="slideshow"&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.stopAnimationLoop(),this},destroy:function(){return this.selectedType==="video"&&(this.videoWidget&&this.videoWidget.destroy(),this.videoWidget=null),this.selectedType==="slideshow"&&(this.slideshowWidget&&this.slideshowWidget.destroy(),this.slideshowWidget=null),t.prototype.destroy.apply(this,arguments)},hasVideoBG:function(){return!!(!RM.screenshot&&this.selectedType==="video"&&this.video&&this.video.url)},renderPicture:function(){if(!this.picture){this.widgetIsLoaded();return}let d=e.useLambdaUrl(this.picture)||e.useLambdaUrlOldProjects(this.picture,"background")?e.getLambdaUrl(this.picture):this.picture.finalUrl||this.picture.effectUrl||this.picture.unscaledOptimizedUrl||this.picture.url;(0,n.default)("<img/>").on("load",s.default.bind(function(){this.$picture.css({"background-image":"url("+d+")"}),RM.screenshot?setTimeout(this.widgetIsLoaded,200):this.widgetIsLoaded()},this)).on("error",this.widgetIsLoaded).attr("src",d)},renderSlideshow:function(){this.slideshowWidget=new o({data:this.slideshow,container:this.$slideshow,preloadContainer:this.$slideshowPreload,name:this.page.cid}),RM.screenshot?(this.slideshowWidget.render(),this.slideshowWidget.on("loaded",function(){this.widgetIsLoaded()}.bind(this))):(this.slideshowWidget.render(!this.page.isCurrent()),this.widgetIsLoaded())},renderVideo:function(){this.videoWidget=new r({el:this.$videoContainer.get(0),model:new l.default.Model({video:this.video}),attributes:{thumbnailMode:window.RM.screenshot}}),this.videoWidget.on("loaded",()=>{this.widgetIsLoaded()}),this.videoWidget.on("playStarted",()=>{this.trigger("videoBGStarted")}),this.videoWidget.render()}}),b=m;export{b as default};
