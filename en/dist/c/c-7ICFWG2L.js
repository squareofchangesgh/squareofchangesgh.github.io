import{a as A}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-HMIKWVPL.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-2TSYQWVN.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-Q27SXLTB.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-OKZSTQSX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-L26XEBE2.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-YIBTG3FD.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-42SFA7ZB.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TQMFKW4O.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-5SLUZRMW.js";import{a as U,b as tt}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-K45ZXRYF.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-4NSILI54.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-PEYC24KP.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-XJQ7OF5W.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-22ZYTENX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-I6RXPP7W.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TW324QB3.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-DQDVK4WP.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-MXQB3LDA.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-7JDZLQQ4.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-JWQSDUFI.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-SUQN7X7E.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-WVUZA6DL.js";import{l as _,m as Y,r as D,s as Z}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-42TSFLLH.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TBONR54I.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-JTEJSVZP.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-OEU46UX3.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-5R57BBFA.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-G4GX3XOZ.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-Y3K5ZMDI.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-HKXDGYOU.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-Y4QUC5YI.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-US7HSDUX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-AG4TV67I.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-VRG4AYQX.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-VNZOBZZU.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-MBWT6D3G.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-BHZEZWL4.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-VUD7OPNE.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-M4TEEAX7.js";import{b as N,c as X}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-SXBIDYQQ.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-PR2DJXFR.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-GJYOXBH4.js";import{a as Q}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-3SFTLRL3.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-W2OJRSJR.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-CDLDI33S.js";import"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-KGGRYMSL.js";import{b as V,d as B}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TZYDFHR2.js";var K=V((it,M)=>{"use strict";(function(){function o(t,i){document.addEventListener?t.addEventListener("scroll",i,!1):t.attachEvent("scroll",i)}function n(t){document.body?t():document.addEventListener?document.addEventListener("DOMContentLoaded",function i(){document.removeEventListener("DOMContentLoaded",i),t()}):document.attachEvent("onreadystatechange",function i(){(document.readyState=="interactive"||document.readyState=="complete")&&(document.detachEvent("onreadystatechange",i),t())})}function a(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function r(t,i){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+i+";"}function d(t){var i=t.a.offsetWidth,e=i+100;return t.f.style.width=e+"px",t.c.scrollLeft=e,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==i?(t.g=i,!0):!1}function z(t,i){function e(){var f=C;d(f)&&f.a.parentNode&&i(f.g)}var C=t;o(t.b,e),o(t.c,e),d(t)}function y(t,i){var e=i||{};this.family=t,this.style=e.style||"normal",this.weight=e.weight||"normal",this.stretch=e.stretch||"normal"}var S=null,v=null,E=null,W=null;function H(){if(v===null)if(L()&&/Apple/.test(window.navigator.vendor)){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);v=!!t&&603>parseInt(t[1],10)}else v=!1;return v}function L(){return W===null&&(W=!!document.fonts),W}function q(){if(E===null){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch{}E=t.style.font!==""}return E}function g(t,i){return[t.style,t.weight,q()?t.stretch:"","100px",i].join(" ")}y.prototype.load=function(t,i){var e=this,C=t||"BESbswy",f=0,b=i||3e3,F=new Date().getTime();return new Promise(function(P,O){if(L()&&!H()){var G=new Promise(function(w,x){function h(){new Date().getTime()-F>=b?x(Error(""+b+"ms timeout exceeded")):document.fonts.load(g(e,'"'+e.family+'"'),C).then(function(p){1<=p.length?w():setTimeout(h,25)},x)}h()}),J=new Promise(function(w,x){f=setTimeout(function(){x(Error(""+b+"ms timeout exceeded"))},b)});Promise.race([J,G]).then(function(){clearTimeout(f),P(e)},O)}else n(function(){function w(){var s;(s=l!=-1&&u!=-1||l!=-1&&m!=-1||u!=-1&&m!=-1)&&((s=l!=u&&l!=m&&u!=m)||(S===null&&(s=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),S=!!s&&(536>parseInt(s[1],10)||parseInt(s[1],10)===536&&11>=parseInt(s[2],10))),s=S&&(l==T&&u==T&&m==T||l==j&&u==j&&m==j||l==$&&u==$&&m==$)),s=!s),s&&(c.parentNode&&c.parentNode.removeChild(c),clearTimeout(f),P(e))}function x(){if(new Date().getTime()-F>=b)c.parentNode&&c.parentNode.removeChild(c),O(Error(""+b+"ms timeout exceeded"));else{var s=document.hidden;(s===!0||s===void 0)&&(l=h.a.offsetWidth,u=p.a.offsetWidth,m=I.a.offsetWidth,w()),f=setTimeout(x,50)}}var h=new a(C),p=new a(C),I=new a(C),l=-1,u=-1,m=-1,T=-1,j=-1,$=-1,c=document.createElement("div");c.dir="ltr",r(h,g(e,"sans-serif")),r(p,g(e,"serif")),r(I,g(e,"monospace")),c.appendChild(h.a),c.appendChild(p.a),c.appendChild(I.a),document.body.appendChild(c),T=h.a.offsetWidth,j=p.a.offsetWidth,$=I.a.offsetWidth,x(),z(h,function(s){l=s,w()}),r(h,g(e,'"'+e.family+'",sans-serif')),z(p,function(s){u=s,w()}),r(p,g(e,'"'+e.family+'",serif')),z(I,function(s){m=s,w()}),r(I,g(e,'"'+e.family+'",monospace'))})})},typeof M=="object"?M.exports=y:(window.FontFaceObserver=y,window.FontFaceObserver.prototype.load=y.prototype.load)})()});var k=B(Q());var R=B(K());Z();X();tt();Y();var et=A.extend({initialize:function(){A.prototype.initialize.apply(this,arguments),this.is_above&&this.mag.on("destroyed",this.destroy),this["bar-auto-open"]&&(this.mag.eCommerceCartManager.openSidebarOnAddItem=!0),this.mag.eCommerceManager.setCartWidgetExistState(!0)},render:function(){let o=!1;if(RM.screenshot)window.ServerData.userPermissions&&window.ServerData.userPermissions.can_use_e_commerce&&(o=!0);else{let n=U.getPermissions();n&&n.can_use_e_commerce&&(o=!0)}if(!o)return this.widgetIsLoaded(),this;if(A.prototype.render.apply(this,[{withoutHoverCursor:!0}]),this.$el.addClass("e-com-cart-button"),!RM.screenshot){_.on("ecommerce:cartdata:changed",this.renderTotalItems);let n=this["font-family"];n&&!N.systemFontsList.includes(n.toLowerCase())?new R.default(this["font-family"]).load().then(()=>{this.renderTotalItems(this.mag.eCommerceCartManager.getCartData())}).catch(()=>{this.renderTotalItems(this.mag.eCommerceCartManager.getCartData())}):this.renderTotalItems(this.mag.eCommerceCartManager.getCartData())}return this},renderTotalItems:function(o){if(!o||!o.skus&&!o.prices)return;let n=0;for(let d in o.skus)o.skus.hasOwnProperty(d)&&(n+=o.skus[d].cart_count);for(let d in o.prices)o.prices.hasOwnProperty(d)&&(n+=o.prices[d].cart_count);let a=n?`${this.text||""} ${n}`:this.text||"",r=this.recalcTextInputSize(a);this.renderButtonTextWithSizes(a,r)},onButtonClick:function(){this.mag.eCommerceCartManager.changeCartSidebarVisibility()},recalcTextInputSize:function(o){let n,a,r,d,z=this["font-size"],y=this["letter-spacing"],S=this["font-family"],v=this["font-style"],E=this["font-weight"];return this.$textInputSizeAdjuster||(this.$textInputSizeAdjuster=(0,k.default)("<div/>"),this.$textInputSizeAdjuster.css({position:"absolute",left:"-9999px",top:"-9999px","white-space":"pre",width:"auto"}),(0,k.default)(document.getElementById("tmp")).append(this.$textInputSizeAdjuster)),this.$textInputSizeAdjuster.addClass("for-text-size-calc").addClass(D.generateUUID()),this.$textInputSizeAdjuster.text(o.trim()),this.$textInputSizeAdjuster.css({"font-family":S,"font-style":v,"font-weight":E,"font-size":z+"px","letter-spacing":y+"px"}),n=this.$textInputSizeAdjuster.width(),a=this.$textInputSizeAdjuster.height(),this.$textInputSizeAdjuster.css("letter-spacing",0).text("M"),r=this.$textInputSizeAdjuster.width(),r=Math.ceil(r/2)*2,d=this.$textInputSizeAdjuster.height(),o.length===0&&(n=r,a=d),n=Math.ceil(n/2)*2,n=n+r,a=Math.ceil(a/2)*2,{text_w:n,text_h:a}},destroy:function(){return _.off("ecommerce:cartdata:changed",this.renderTotalItems),this.$textInputSizeAdjuster&&(this.$textInputSizeAdjuster.remove(),this.$textInputSizeAdjuster=null),A.prototype.destroy.apply(this,arguments)}}),dt=et;export{dt as default};
