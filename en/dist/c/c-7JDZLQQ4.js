import{a as w,b as m}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-JWQSDUFI.js";import{a as y}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TZYDFHR2.js";var l,B,M=y(()=>{"use strict";m();l={sideAngles:{top:0,right:Math.PI*.5,bottom:Math.PI,left:Math.PI*1.5},calcOrientedTriangleSquare:function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},intersectsOnAxisProjection:function(t,e,n,i){let h;return t>e&&(h=t,t=e,e=h),n>i&&(h=n,n=i,i=h),t<n&&(t=n),e>i&&(e=i),t<=e},isLinesIntersects:function(t,e,n,i){return l.intersectsOnAxisProjection(t.x,e.x,n.x,i.x)&&l.intersectsOnAxisProjection(t.y,e.y,n.y,i.y)&&l.calcOrientedTriangleSquare(t,e,n)*l.calcOrientedTriangleSquare(t,e,i)<=0&&l.calcOrientedTriangleSquare(n,i,t)*l.calcOrientedTriangleSquare(n,i,e)<=0},isConvexPolygonContainsPoint:function(t,e){for(let n=0;n<t.length;n++){let i=(n+1)%t.length;if(l.calcOrientedTriangleSquare(t[n],t[i],e)<0)return!1}return!0},isConvexPolygonsIntersects:function(t,e){let n,i,h,o;for(n=0;n<t.length;n++)if(l.isConvexPolygonContainsPoint(e,t[n]))return!0;for(n=0;n<e.length;n++)if(l.isConvexPolygonContainsPoint(t,e[n]))return!0;for(n=0;n<t.length;n++)for(i=(n+1)%t.length,h=0;h<e.length;h++)if(o=(h+1)%e.length,l.isLinesIntersects(t[n],t[i],e[h],e[o]))return!0;return!1},doBoundingBoxesIntersect:function(t,e){return t&&e&&!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)},calcBoundingBoxForBlock:function(t,e,n){let i=t.getBoxData(),h=Math.sin(-(t.model.get("angle")||0)*Math.PI/180),o=Math.cos(-(t.model.get("angle")||0)*Math.PI/180),s=!!t.model.get("fixed_position"),r=t.model.get("shadow")||{x:0,y:0,blur:0};if(n&&(r.x||r.y||r.blur)){let g={height:i.h+r.blur*2,width:i.w+r.blur*2,top:i.y+r.y-r.blur,left:i.x+r.x-r.blur},u=this.getBoundingBoxOfBoxes([{width:i.w,height:i.h,left:i.x,top:i.y},g]);return this.calcBoundingBox({...u,sinAngle:h,cosAngle:o},s,e)}else return this.calcBoundingBox({height:i.h,width:i.w,top:i.y,left:i.x,sinAngle:h,cosAngle:o},s,e)},calcBoundingBox:function(t,e,n){let i=l.calcRotatedBox(t),h=i.map(p=>p.x),o=i.map(p=>p.y),s=Math.min.apply(null,h),r=Math.max.apply(null,h),g=Math.min.apply(null,o),u=Math.max.apply(null,o),c=s,f=g,a=r-s,d=u-g;return e&&(["n","c","s"].indexOf(e)>-1&&(c=t.left),["w","c","e"].indexOf(e)>-1&&(f=t.top)),n?{width:a,height:d,left:c,top:f}:{bb_width:a,bb_height:d,bb_left:c,bb_top:f}},boxToRect:function(t){return{width:t.width,height:t.height,top:t.top,bottom:t.top+t.height,left:t.left,right:t.left+t.width}},getBoundingBoxOfElements(t,e=1){let n=t.map(i=>i.parentElement?e!==1?w.getBox(i,e):i.getBoundingClientRect():{bottom:0,height:0,left:0,right:0,top:0,width:0});return l.getBoundingBoxOfBoxes(n)},getBoundingBoxOfBoxes:function(t){let e=[],n=[];for(let h of t){let o=typeof h.right<"u"?h instanceof DOMRect?h.toJSON():{...h}:l.boxToRect(h);e.push(o.left),e.push(o.right),n.push(o.top),n.push(o.bottom)}let i={top:Math.min.apply(null,n),right:Math.max.apply(null,e),bottom:Math.max.apply(null,n),left:Math.min.apply(null,e)};return i.width=i.right-i.left,i.height=i.bottom-i.top,i},getBoundingBoxOfBlocks(t=[]){let e=t.map(n=>{let i=n.getBoxData({includeBoundingBox:!0,checkFixedPosition:!0});return{width:i.bb_w,height:i.bb_h,top:i.bb_y,left:i.bb_x}});return l.getBoundingBoxOfBoxes(e)},calcRotatedBox:function(t){let e=[],n=[0,1,1,0],i=[0,0,1,1],h=t.left+t.width/2,o=t.top+t.height/2,s=t.sinAngle,r=t.cosAngle;return n.forEach((g,u)=>{let c=t.left+t.width*n[u],f=t.top+t.height*i[u],a=c-h,d=o-f;c=h+r*a+s*d,f=o+s*a-r*d,e.push({x:c,y:f})}),e},getDistance:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},getBestPoints:function(t,e){let n=["right","left","bottom","top"],i={distance:1/0,fromPoint:{},toPoint:{}},h,o,s;for(let r=0;r<n.length;r++)for(let g=0;g<n.length;g++)o=l.getSideCenter(t,n[r]),s=l.getSideCenter(e,n[g]),h=l.getDistance(o,s),i=h<i.distance?{distance:h,fromSide:n[r],fromPoint:o,toSide:n[g],toPoint:s}:i;return i},getSideCenter:function(t,e){let n;switch(e){case"left":n={x:t.left,y:t.top+t.height/2};break;case"top":n={x:t.left+t.width/2,y:t.top};break;case"bottom":n={x:t.left+t.width/2,y:t.top+t.height};break;case"right":default:n={x:t.left+t.width,y:t.top+t.height/2};break}return n={x:(n.x-t.centerX)*t.cos-(n.y-t.centerY)*t.sin+t.centerX,y:(n.y-t.centerY)*t.cos+(n.x-t.centerX)*t.sin+t.centerY},n},getPerpendicularEnd:function(t,e,n,i){let h=n.angle+l.sideAngles[t];return{x:i*Math.sin(h)+e.x,y:-i*Math.cos(h)+e.y}},getBox:function(t){let n=(t.$el&&t.$el[0]||t.length&&t[0]||t).getBoundingClientRect().toJSON(),i=t.model?(t.model.attributes.angle||0)*Math.PI/180:0;return n={...n,angle:i,sin:Math.sin(i),cos:Math.cos(i)},n={...n,centerX:n.left+n.width/2,centerY:n.top+n.height/2},n},getResizedBoxNested:function(t,e,n,i){let h=n.width/e.width,o=n.height/e.height;return h=i==="height"?o:h,o=i==="width"?h:o,{left:(t.left-e.left)*h+n.left,top:(t.top-e.top)*o+n.top,width:t.width*h,height:t.height*o}},getResizedBoxByBB:function(t,e,n,{sin:i,cos:h}={sin:0,cos:1}){let o={left:n.left+n.width/2,top:n.top+n.height/2},s=n.width/e.width,r=n.height/e.height,g=!![0,-1,1].find(a=>Math.abs(i-a)<=1e-6),u=Math.min(s,r),{width:c,height:f}=g?{width:Math.abs(t.width*s*h+t.width*r*i),height:Math.abs(t.height*r*h+t.height*s*i)}:{width:t.width*u,height:t.height*u};return{left:o.left-c/2,top:o.top-f/2,width:c,height:f}},getBoxLimits:function(t,e){let n=t.width/t.height>1,i=n?e.minheight/t.height:e.minwidth/t.width,h=n?e.maxwidth/t.width:e.maxheight/t.height;return{minwidth:e.minwidth?Math.round(t.width*i):1,minheight:e.minheight?Math.round(t.height*i):1,maxwidth:e.maxwidth?Math.round(t.width*h):1/0,maxheight:e.maxheight?Math.round(t.height*h):1/0}},isBoxInView(t,e=.2){let n=e?e*t.height:1,i=e?e*t.width:1,h=t.height&&t.bottom>=n&&t.bottom<=window.innerHeight,o=t.height&&t.top<=window.innerHeight-n&&t.top>0,s=t.width&&t.right>=i&&t.right<=window.innerWidth,r=t.width&&t.left<=window.innerWidth-i&&t.left>0;return(h||o)&&(s||r)},getScaleToFit(t={},e={}){if(!e.width&&!e.height)return 0;let n=t.width/t.height;return(e.width||1/0)/(e.height||1/0)>n?(e.height||1/0)/t.height:(e.width||1/0)/t.width},incrementCircular(t,e){return t%e+1<=e?t%e+1:1},decrementCircular(t,e){return t>1?t-1:e},calculateResizedShapeBox(t,e,{height:n,width:i}){let{angle:h}=t,o,s,r={height:0,width:0,left:0,top:0};return(e.deltaX>0||e.deltaY<0)&&(o=t.left+Math.abs(e.deltaX||e.deltaY)/2,s=t.top-Math.abs(e.deltaX||e.deltaY)/2),(e.deltaX<0||e.deltaY>0)&&(o=t.left-Math.abs(e.deltaX||e.deltaY)/2,s=t.top+Math.abs(e.deltaX||e.deltaY)/2),h!==0&&h!==180?(r.height=n+e.deltaX,r.width=i+e.deltaY,r.left=o,r.top=s):(r.height=n+e.deltaY,r.width=i+e.deltaX,r.left=t.left,r.top=t.top),{...t,...r}}},B=l});export{B as a,M as b};
