import{b as pt}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-B44ZIHQO.js";import{a as x,b as dt}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-SUQN7X7E.js";import{a as K}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-MBWT6D3G.js";import{a as y,d as H}from"https://st-p.rmcdn1.net/e0cde9ba/dist/c/c-TZYDFHR2.js";function R(t,r){let a=`atom${++St}`,p={toString:()=>a};return typeof t=="function"?p.read=t:(p.init=t,p.read=function(S){return S(this)},p.write=function(S,m,h){return m(this,typeof h=="function"?h(S(this)):h)}),r&&(p.write=r),p}var St,z,j,U,mt,X,Y,Z,vt,_,Q,b,Tt,D,tt,k,et,F=y(()=>{"use strict";St=0;z=t=>"init"in t,j=t=>!!t.write,U=new WeakMap,mt=(t,r)=>{U.set(t,r),t.catch(()=>{}).finally(()=>U.delete(t))},X=(t,r)=>{let a=U.get(t);a&&(U.delete(t),a(r))},Y=(t,r)=>{t.status="fulfilled",t.value=r},Z=(t,r)=>{t.status="rejected",t.reason=r},vt=t=>typeof t?.then=="function",_=(t,r)=>!!t&&"v"in t&&"v"in r&&Object.is(t.v,r.v),Q=(t,r)=>!!t&&"e"in t&&"e"in r&&Object.is(t.e,r.e),b=t=>!!t&&"v"in t&&t.v instanceof Promise,Tt=(t,r)=>"v"in t&&"v"in r&&t.v.orig&&t.v.orig===r.v.orig,D=t=>{if("e"in t)throw t.e;return t.v},tt=()=>{let t=new WeakMap,r=new WeakMap,a=new Map,p,S;(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(p=new Set,S=new Set);let m=e=>t.get(e),h=(e,n)=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&Object.freeze(n);let s=t.get(e);if(t.set(e,n),a.has(e)||a.set(e,s),b(s)){let o="v"in n?n.v instanceof Promise?n.v:Promise.resolve(n.v):Promise.reject(n.e);s.v!==o&&X(s.v,o)}},g=(e,n,s)=>{let o=new Map,u=!1;s.forEach((f,i)=>{!f&&i===e&&(f=n),f?(o.set(i,f),n.d.get(i)!==f&&(u=!0)):(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[Bug] atom state not found")}),(u||n.d.size!==o.size)&&(n.d=o)},A=(e,n,s)=>{let o=m(e),u={d:o?.d||new Map,v:n};if(s&&g(e,u,s),_(o,u)&&o.d===u.d)return o;if(b(o)&&b(u)&&Tt(o,u)){if(o.d===u.d)return o;u.v=o.v}return h(e,u),u},w=(e,n,s,o)=>{if(vt(n)){let u,f=()=>{let c=m(e);if(!b(c)||c.v!==i)return;let v=A(e,i,s);r.has(e)&&c.d!==v.d&&$(e,v,c.d)},i=new Promise((c,v)=>{let l=!1;n.then(d=>{l||(l=!0,Y(i,d),c(d),f())},d=>{l||(l=!0,Z(i,d),v(d),f())}),u=d=>{l||(l=!0,d.then(T=>Y(i,T),T=>Z(i,T)),c(d))}});return i.orig=n,i.status="pending",mt(i,c=>{c&&u(c),o?.()}),A(e,i,s)}return A(e,n,s)},V=(e,n,s)=>{let o=m(e),u={d:o?.d||new Map,e:n};return s&&g(e,u,s),Q(o,u)&&o.d===u.d?o:(h(e,u),u)},E=(e,n)=>{let s=m(e);if(!n&&s&&(r.has(e)||Array.from(s.d).every(([l,d])=>{if(l===e)return!0;let T=E(l);return T===d||_(T,d)})))return s;let o=new Map,u=!0,f=l=>{if(l===e){let T=m(l);if(T)return o.set(l,T),D(T);if(z(l))return o.set(l,void 0),l.init;throw new Error("no atom init")}let d=E(l);return o.set(l,d),D(d)},i,c,v={get signal(){return i||(i=new AbortController),i.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!j(e)&&console.warn("setSelf function cannot be used with read-only atom"),!c&&j(e)&&(c=(...l)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&u&&console.warn("setSelf function cannot be called in sync"),!u)return I(e,...l)}),c}};try{let l=e.read(f,v);return w(e,l,o,()=>i?.abort())}catch(l){return V(e,l,o)}finally{u=!1}},J=e=>D(E(e)),ft=e=>{let n=r.get(e);return n||(n=C(e)),n},P=(e,n)=>!n.l.size&&(!n.t.size||n.t.size===1&&n.t.has(e)),lt=e=>{let n=r.get(e);n&&P(e,n)&&N(e)},q=e=>{let n=new Map,s=new WeakMap,o=i=>{var c;let v=new Set((c=r.get(i))==null?void 0:c.t);return a.forEach((l,d)=>{var T;(T=m(d))!=null&&T.d.has(i)&&v.add(d)}),v},u=i=>{o(i).forEach(c=>{c!==i&&(n.set(c,(n.get(c)||new Set).add(i)),s.set(c,(s.get(c)||0)+1),u(c))})};u(e);let f=i=>{o(i).forEach(c=>{var v;if(c!==i){let l=s.get(c);if(l&&s.set(c,--l),!l){let d=!!((v=n.get(c))!=null&&v.size);if(d){let T=m(c),at=E(c,!0);d=!_(T,at)}d||n.forEach(T=>T.delete(c))}f(c)}})};f(e)},L=(e,...n)=>{let s=!0,o=i=>D(E(i)),u=(i,...c)=>{let v;if(i===e){if(!z(i))throw new Error("atom not writable");let l=m(i),d=w(i,c[0]);_(l,d)||q(i)}else v=L(i,...c);if(!s){let l=O();(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&p.forEach(d=>d({type:"async-write",flushed:l}))}return v},f=e.write(o,u,...n);return s=!1,f},I=(e,...n)=>{let s=L(e,...n),o=O();return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&p.forEach(u=>u({type:"write",flushed:o})),s},C=(e,n,s)=>{var o;let u=s||[];(o=m(e))==null||o.d.forEach((i,c)=>{let v=r.get(c);v?v.t.add(e):c!==e&&C(c,e,u)}),E(e);let f={t:new Set(n&&[n]),l:new Set};if(r.set(e,f),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&S.add(e),j(e)&&e.onMount){let{onMount:i}=e;u.push(()=>{let c=i((...v)=>I(e,...v));c&&(f.u=c)})}return s||u.forEach(i=>i()),f},N=e=>{var n;let s=(n=r.get(e))==null?void 0:n.u;s&&s(),r.delete(e),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&S.delete(e);let o=m(e);o?(b(o)&&X(o.v),o.d.forEach((u,f)=>{if(f!==e){let i=r.get(f);i&&(i.t.delete(e),P(f,i)&&N(f))}})):(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[Bug] could not find atom state to unmount",e)},$=(e,n,s)=>{let o=new Set(n.d.keys());s?.forEach((u,f)=>{if(o.has(f)){o.delete(f);return}let i=r.get(f);i&&(i.t.delete(e),P(f,i)&&N(f))}),o.forEach(u=>{let f=r.get(u);f?f.t.add(e):r.has(e)&&C(u,e)})},O=()=>{let e;for((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(e=new Set);a.size;){let n=Array.from(a);a.clear(),n.forEach(([s,o])=>{let u=m(s);if(u){let f=r.get(s);f&&u.d!==o?.d&&$(s,u,o?.d),f&&!(!b(o)&&(_(o,u)||Q(o,u)))&&(f.l.forEach(i=>i()),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&e.add(s))}else(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[Bug] no atom state to flush")})}if((import.meta.env?import.meta.env.MODE:void 0)!=="production")return e},G=(e,n)=>{let s=ft(e),o=O(),u=s.l;return u.add(n),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&p.forEach(f=>f({type:"sub",flushed:o})),()=>{u.delete(n),lt(e),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&p.forEach(f=>f({type:"unsub"}))}};return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?{get:J,set:I,sub:G,dev_subscribe_store:(e,n)=>{if(n!==2)throw new Error("The current StoreListener revision is 2.");return p.add(e),()=>{p.delete(e)}},dev_get_mounted_atoms:()=>S.values(),dev_get_atom_state:e=>t.get(e),dev_get_mounted:e=>r.get(e),dev_restore_atoms:e=>{for(let[s,o]of e)z(s)&&(w(s,o),q(s));let n=O();p.forEach(s=>s({type:"restore",flushed:n}))}}:{get:J,set:I,sub:G}};(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(typeof globalThis.__NUMBER_OF_JOTAI_INSTANCES__=="number"?++globalThis.__NUMBER_OF_JOTAI_INSTANCES__:globalThis.__NUMBER_OF_JOTAI_INSTANCES__=1);et=()=>(k||((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&globalThis.__NUMBER_OF_JOTAI_INSTANCES__!==1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"),k=tt()),k)});function At(t,r){let a=ot(r),[[p,S,m],h]=(0,M.useReducer)(w=>{let V=a.get(t);return Object.is(w[0],V)&&w[1]===a&&w[2]===t?w:[V,a,t]},void 0,()=>[a.get(t),a,t]),g=p;(S!==a||m!==t)&&(h(),g=a.get(t));let A=r?.delay;return(0,M.useEffect)(()=>{let w=a.sub(t,()=>{if(typeof A=="number"){setTimeout(h,A);return}h()});return h(),w},[a,t,A]),(0,M.useDebugValue)(g),Mt(g)?gt(g):g}function B(t,r){let a=ot(r);return(0,M.useCallback)((...S)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return a.set(t,...S)},[a,t])}function nt(t,r){return[At(t,r),B(t,r)]}var M,ht,ot,Mt,gt,rt=y(()=>{"use strict";M=H(K(),1);F();ht=(0,M.createContext)(void 0),ot=t=>{let r=(0,M.useContext)(ht);return t?.store||r||et()},Mt=t=>typeof t?.then=="function",gt=M.default.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(r=>{t.status="fulfilled",t.value=r},r=>{t.status="rejected",t.reason=r}),t)})});var W=y(()=>{"use strict";F();rt()});function it(t,r){let a;function p(){typeof a=="function"&&a()}let S=R(t,(m,h,g)=>{let A=st(g)?g:g(m(S));h(S,A),p();let w=r(A);typeof w=="function"&&(a=w)});return S.onMount=()=>{let m=r(t);return typeof m=="function"&&(a=m),p},S}function st(t){return typeof t!="function"}var ut=y(()=>{"use strict";W()});function ct(t,r){return typeof r=="function"?it(t,r):R(t)}function Wt(t,r,a){let p=typeof r<"u",S=p?ct(r,a):null;function m(){if(S===null)throw new x("The store has not been initialized. Please initialize it before use.",{name:t});return nt(S)}function h(){if(S===null)throw new x("The store has not been initialized. Please initialize it before use.",{name:t});return B(S)}function g(A){S=ct(typeof A=="function"?A():A,a)}return p?{useStore:m,useSetState:h}:{initStore:g,useStore:m,useSetState:h}}var wt,Et=y(()=>{"use strict";wt=H(K());pt();W();dt();ut()});export{Wt as a,Et as b};
